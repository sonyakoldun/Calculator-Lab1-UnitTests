# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ1: –ú–æ–¥—É–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ç–æ–¥—É RunEstimate

## üìã –ó–º—ñ—Å—Ç
1. [–û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É](#–æ–ø–∏—Å-–ø—Ä–æ—î–∫—Ç—É)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ—î–∫—Ç—É)
3. [–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è](#–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è-—Ç–∞-–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è)
4. [–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤](#–∑–∞–ø—É—Å–∫-—Ç–µ—Å—Ç—ñ–≤)
5. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–±–∞–∑–∏-–¥–∞–Ω–∏—Ö)
6. [–û–ø–∏—Å —Ç–µ—Å—Ç—ñ–≤](#–æ–ø–∏—Å-—Ç–µ—Å—Ç—ñ–≤)

---

## üìå –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É

–¶—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ —Ä–µ–∞–ª—ñ–∑—É—î **–º–æ–¥—É–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è** –º–µ—Ç–æ–¥—É `RunEstimate()` –∑ –∫–ª–∞—Å—É `AnalaizerClass` –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ `AnalizerClassLibrary`.

**–í–∞—Ä—ñ–∞–Ω—Ç:** ‚Ññ9  
**–ú–µ—Ç–æ–¥:** `public static string RunEstimate()`  
**–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞:** `AnalaizerClassLibrary`

### –©–æ —Ä–æ–±–∏—Ç—å –º–µ—Ç–æ–¥ RunEstimate?

–ú–µ—Ç–æ–¥ `RunEstimate()` –æ–±—á–∏—Å–ª—é—î –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏–π –≤–∏—Ä–∞–∑, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —É —Ñ–æ—Ä–º–∞—Ç—ñ –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –ø–æ–ª—å—Å—å–∫–æ–≥–æ –∑–∞–ø–∏—Å—É (RPN - Reverse Polish Notation):

1. –í–∏–∫–ª–∏–∫–∞—î `CreateStack()` –¥–ª—è –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏—Ä–∞–∑—É –≤ –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –ø–æ–ª—å—Å—å–∫–∏–π –∑–∞–ø–∏—Å
2. –û–±—Ä–æ–±–ª—è—î —á–µ—Ä–≥—É –æ–ø–µ—Ä–∞—Ç–æ—Ä—ñ–≤ —Ç–∞ –æ–ø–µ—Ä–∞–Ω–¥—ñ–≤
3. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–µ–∫ –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
4. –í–∏–∫–ª–∏–∫–∞—î –º–µ—Ç–æ–¥–∏ –∑ `CalcClass` (Add, Sub, Mult, Div, Mod, ABS, IABS)
5. –ü–æ–≤–µ—Ä—Ç–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–±–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É (–ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ "&")

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
Calculator/
‚îú‚îÄ‚îÄ AnalizerClassLibrary/          # –û—Å–Ω–æ–≤–Ω–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ (—Ç–µ—Å—Ç—É—î—Ç—å—Å—è)
‚îÇ   ‚îî‚îÄ‚îÄ AnalaizerClass.cs          # –ö–ª–∞—Å –∑ –º–µ—Ç–æ–¥–æ–º RunEstimate
‚îú‚îÄ‚îÄ AnalizerClassLibrary.Tests/    # –ü—Ä–æ—î–∫—Ç –∑ unit —Ç–µ—Å—Ç–∞–º–∏ ‚≠ê
‚îÇ   ‚îú‚îÄ‚îÄ RunEstimateTests.cs        # –ö–ª–∞—Å –∑ —Ç–µ—Å—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ App.config                 # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è (—Ä—è–¥–æ–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î)
‚îÇ   ‚îî‚îÄ‚îÄ packages.config            # NuGet –ø–∞–∫–µ—Ç–∏
‚îú‚îÄ‚îÄ Database/                      # SQL —Å–∫—Ä–∏–ø—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ CreateTestDatabase.sql     # –°–∫—Ä–∏–ø—Ç —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ë–î —Ç–∞ —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
‚îú‚îÄ‚îÄ CalcClassBr/                   # –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω—å
‚îî‚îÄ‚îÄ ErrorLibrary/                  # –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –∑ –∫–æ–¥–∞–º–∏ –ø–æ–º–∏–ª–æ–∫
```

---

## üîß –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ **SQL Server Management Studio (SSMS)** –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ `sqlcmd`
2. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ –≤–∞—à–æ–≥–æ SQL Server
3. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª `Database/CreateTestDatabase.sql`
4. –í–∏–∫–æ–Ω–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç (F5 –∞–±–æ –∫–Ω–æ–ø–∫–∞ "Execute")

–°–∫—Ä–∏–ø—Ç —Å—Ç–≤–æ—Ä–∏—Ç—å:
- –ë–∞–∑—É –¥–∞–Ω–∏—Ö `CalculatorTestDB`
- –¢–∞–±–ª–∏—Ü—é `TestExpressions` –∑ —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏
- ~30 —Ç–µ—Å—Ç–æ–≤–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤

### –ö—Ä–æ–∫ 2: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ä—è–¥–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

–í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª `AnalizerClassLibrary.Tests/App.config` —Ç–∞ –∑–º—ñ–Ω—ñ—Ç—å —Ä—è–¥–æ–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ:

```xml
<connectionStrings>
  <add name="TestDatabase" 
       connectionString="Data Source=localhost;Initial Catalog=CalculatorTestDB;Integrated Security=True;..." 
       providerName="System.Data.SqlClient" />
</connectionStrings>
```

**–í–∞–∂–ª–∏–≤–æ:** 
- `Data Source` - –Ω–∞–∑–≤–∞ –≤–∞—à–æ–≥–æ SQL Server (–º–æ–∂–µ –±—É—Ç–∏ `localhost`, `(local)`, `.\SQLEXPRESS` —Ç–æ—â–æ)
- `Integrated Security=True` - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Windows Authentication
- –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ SQL Authentication, –∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞: `User ID=your_user;Password=your_password;`

### –ö—Ä–æ–∫ 3: –í—ñ–¥–∫—Ä–∏—Ç—Ç—è solution –≤ Visual Studio

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª `Calculator_Exam_CommandProject.sln` –≤ Visual Studio
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –ø—Ä–æ—î–∫—Ç `AnalizerClassLibrary.Tests` –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π
3. –í—ñ–¥–Ω–æ–≤—ñ—Ç—å NuGet –ø–∞–∫–µ—Ç–∏ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ): `Tools` ‚Üí `NuGet Package Manager` ‚Üí `Restore NuGet Packages`

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Test Explorer (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ **Test Explorer**: `Test` ‚Üí `Test Explorer` (–∞–±–æ `Ctrl+E, T`)
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Run All"** –∞–±–æ –≤–∏–±–µ—Ä—ñ—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ç–µ—Å—Ç–∏
3. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –º–µ–Ω—é

1. `Test` ‚Üí `Run` ‚Üí `All Tests` (–∞–±–æ `Ctrl+R, A`)

### –í–∞—Ä—ñ–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫

```bash
# –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –ø–∞–ø–∫–∏ –∑ solution
cd "C:\Path\To\Calculator"

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç–∏ —á–µ—Ä–µ–∑ MSBuild
msbuild Calculator_Exam_CommandProject.sln /t:Build
vstest.console.exe AnalizerClassLibrary.Tests\bin\Debug\AnalizerClassLibrary.Tests.dll
```

---

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

### –¢–∞–±–ª–∏—Ü—è: TestExpressions

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å |
|---------|-----|------|
| `Id` | INT (PK, Identity) | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä |
| `TestName` | NVARCHAR(200) | –ù–∞–∑–≤–∞ —Ç–µ—Å—Ç—É |
| `Expression` | NVARCHAR(MAX) | –í—Ö—ñ–¥–Ω–∏–π –≤–∏—Ä–∞–∑ |
| `ExpectedResult` | NVARCHAR(MAX) | –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
| `IsError` | BIT | –ß–∏ –æ—á—ñ–∫—É—î—Ç—å—Å—è –ø–æ–º–∏–ª–∫–∞ (1) —á–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (0) |
| `ErrorCode` | NVARCHAR(50) | –ö–æ–¥ –ø–æ–º–∏–ª–∫–∏ (—è–∫—â–æ IsError = 1) |
| `Description` | NVARCHAR(500) | –û–ø–∏—Å —Ç–µ—Å—Ç—É |
| `TestCategory` | NVARCHAR(50) | –ö–∞—Ç–µ–≥–æ—Ä—ñ—è: Valid, DivisionByZero, Overflow, TooManyOperands, EdgeCase |

### –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç–µ—Å—Ç—ñ–≤:

1. **Valid** - –∫–æ—Ä–µ–∫—Ç–Ω—ñ –≤–∏—Ä–∞–∑–∏, —è–∫—ñ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
2. **DivisionByZero** - –≤–∏—Ä–∞–∑–∏ –∑ –¥—ñ–ª–µ–Ω–Ω—è–º –Ω–∞ 0 (ERROR_09)
3. **Overflow** - –≤–∏—Ä–∞–∑–∏, —â–æ –≤–∏–∫–ª–∏–∫–∞—é—Ç—å –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è int (ERROR_06)
4. **TooManyOperands** - –≤–∏—Ä–∞–∑–∏ –∑ –±—ñ–ª—å—à –Ω—ñ–∂ 30 –æ–ø–µ—Ä–∞–Ω–¥–∞–º–∏ (ERROR_08)
5. **EdgeCase** - –≥—Ä–∞–Ω–∏—á–Ω—ñ –≤–∏–ø–∞–¥–∫–∏ (–æ–¥–∏–Ω –µ–ª–µ–º–µ–Ω—Ç, –Ω—É–ª—å, max/min int)

---

## üß™ –û–ø–∏—Å —Ç–µ—Å—Ç—ñ–≤

### –¢–µ—Å—Ç 1: `RunEstimate_AllTestsFromDatabase`
**–©–æ —Ä–æ–±–∏—Ç—å:** –ß–∏—Ç–∞—î –≤—Å—ñ —Ç–µ—Å—Ç–æ–≤—ñ –≤–∏–ø–∞–¥–∫–∏ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —ó—Ö –ø–æ —á–µ—Ä–∑—ñ.

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –û–¥–∏–Ω —Ç–µ—Å—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î –≤—Å—ñ –≤–∏–ø–∞–¥–∫–∏
- –õ–µ–≥–∫–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ —Ç–µ—Å—Ç–∏ (–ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞–π—Ç–µ –∑–∞–ø–∏—Å –≤ –ë–î)
- –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö

### –¢–µ—Å—Ç 2: `RunEstimate_ValidExpressions`
**–©–æ —Ä–æ–±–∏—Ç—å:** –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Ç—ñ–ª—å–∫–∏ –∫–æ—Ä–µ–∫—Ç–Ω—ñ –≤–∏—Ä–∞–∑–∏ (–∫–∞—Ç–µ–≥–æ—Ä—ñ—è "Valid").

**–ü—Ä–∏–∫–ª–∞–¥–∏:**
- `2+2` ‚Üí `4`
- `(2+3)*4` ‚Üí `20`
- `m5` ‚Üí `-5` (—É–Ω–∞—Ä–Ω–∏–π –º—ñ–Ω—É—Å)

### –¢–µ—Å—Ç 3: `RunEstimate_DivisionByZero`
**–©–æ —Ä–æ–±–∏—Ç—å:** –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –ø–æ–º–∏–ª–∫–∏ –¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ 0.

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –†—è–¥–æ–∫, —â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ `&` —ñ –º—ñ—Å—Ç–∏—Ç—å `Error 09`

### –¢–µ—Å—Ç 4: `RunEstimate_Overflow`
**–©–æ —Ä–æ–±–∏—Ç—å:** –ü–µ—Ä–µ–≤—ñ—Ä—è—î –æ–±—Ä–æ–±–∫—É –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è int.

**–ü—Ä–∏–∫–ª–∞–¥–∏:**
- `2147483647+1` ‚Üí `&Error 06...`

### –¢–µ—Å—Ç 5: `RunEstimate_TooManyOperands`
**–©–æ —Ä–æ–±–∏—Ç—å:** –ü–µ—Ä–µ–≤—ñ—Ä—è—î –æ–±—Ä–æ–±–∫—É –≤–∏–ø–∞–¥–∫—É, –∫–æ–ª–∏ –æ–ø–µ—Ä–∞–Ω–¥—ñ–≤ –±—ñ–ª—å—à–µ 30.

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** `&Error 08`

### –¢–µ—Å—Ç 6: `RunEstimate_EdgeCases`
**–©–æ —Ä–æ–±–∏—Ç—å:** –ü–µ—Ä–µ–≤—ñ—Ä—è—î –≥—Ä–∞–Ω–∏—á–Ω—ñ –≤–∏–ø–∞–¥–∫–∏.

**–ü—Ä–∏–∫–ª–∞–¥–∏:**
- –û–¥–∏–Ω –µ–ª–µ–º–µ–Ω—Ç: `42` ‚Üí `42`
- –ù—É–ª—å: `0` ‚Üí `0`
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è int

### –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ç–µ—Å—Ç–∏ (–±–µ–∑ –ë–î):

- `RunEstimate_SimpleAddition_ReturnsCorrectResult`
- `RunEstimate_SingleElement_ReturnsElement`
- `RunEstimate_DivisionByZero_ReturnsError09`
- `RunEstimate_UnaryMinus_ReturnsNegative`
- `RunEstimate_ComplexExpressionWithBrackets_ReturnsCorrectResult`

---

## üìä –ü–æ–∫—Ä–∏—Ç—Ç—è –∫–æ–¥—É

–¢–µ—Å—Ç–∏ –ø–æ–∫—Ä–∏–≤–∞—é—Ç—å:

‚úÖ **–ö–æ—Ä–µ–∫—Ç–Ω—ñ –≤–∏—Ä–∞–∑–∏:**
- –ü—Ä–æ—Å—Ç—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó (+, -, *, /, %)
- –í–∏—Ä–∞–∑–∏ –∑ –¥—É–∂–∫–∞–º–∏
- –£–Ω–∞—Ä–Ω—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏ (m, p)
- –°–∫–ª–∞–¥–Ω—ñ –≤–∏—Ä–∞–∑–∏

‚úÖ **–ü–æ–º–∏–ª–∫–∏:**
- –î—ñ–ª–µ–Ω–Ω—è –Ω–∞ 0 (ERROR_09)
- –ü–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è int (ERROR_06)
- –ó–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ –æ–ø–µ—Ä–∞–Ω–¥—ñ–≤ (ERROR_08)

‚úÖ **–ì—Ä–∞–Ω–∏—á–Ω—ñ –≤–∏–ø–∞–¥–∫–∏:**
- –û–¥–∏–Ω –µ–ª–µ–º–µ–Ω—Ç —É —á–µ—Ä–∑—ñ
- –ù—É–ª—å
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ/–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è int

---

## üîç –Ø–∫ –ø—Ä–∞—Ü—é—î —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è?

### –ö—Ä–æ–∫ 1: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–∏—Ä–∞–∑—É

–ü–µ—Ä–µ–¥ –≤–∏–∫–ª–∏–∫–æ–º `RunEstimate()` –≤–∏—Ä–∞–∑ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏:

```csharp
private string PrepareExpression(string inputExpression)
{
    // 1. –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ expression
    AnalaizerClass.expression = inputExpression;
    
    // 2. –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –≤–∞–ª—ñ–¥–Ω—ñ—Å—Ç—å –¥—É–∂–æ–∫
    if (!AnalaizerClass.CheckCurrency())
        return null;
    
    // 3. –ó–∞–º—ñ–Ω—é—î–º–æ —É–Ω–∞—Ä–Ω—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏ (+ ‚Üí p, - ‚Üí m)
    AnalaizerClass.expression = AnalaizerClass.ReplaceUnaryPlusMinus(...);
    
    // 4. –§–æ—Ä–º–∞—Ç—É—î–º–æ –≤–∏—Ä–∞–∑
    string formatted = AnalaizerClass.Format();
    
    return formatted;
}
```

### –ö—Ä–æ–∫ 2: –í–∏–∫–ª–∏–∫ RunEstimate

```csharp
AnalaizerClass.expression = preparedExpression;
string result = AnalaizerClass.RunEstimate();
```

### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É

```csharp
if (isError)
{
    Assert.IsTrue(result.StartsWith("&"));
    Assert.IsTrue(result.Contains("Error 09"));
}
else
{
    Assert.AreEqual(expectedResult, result);
}
```

---

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤—ñ –ø—Ä–∏–º—ñ—Ç–∫–∏

1. **–°—Ç–∞—Ç–∏—á–Ω–µ –ø–æ–ª–µ `expression`:** –ú–µ—Ç–æ–¥ `RunEstimate()` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–∞—Ç–∏—á–Ω–µ –ø–æ–ª–µ `AnalaizerClass.expression`. –ü—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–µ—Å—Ç—É –≤–æ–Ω–æ –æ—á–∏—â–∞—î—Ç—å—Å—è –≤ `TestCleanup()`.

2. **–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–∏—Ä–∞–∑—É:** `RunEstimate()` –≤–∏–∫–ª–∏–∫–∞—î `CreateStack()`, —è–∫–∏–π –ø–æ—Ç—Ä–µ–±—É—î –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–∏–π –≤–∏—Ä–∞–∑. –¢–æ–º—É –ø–µ—Ä–µ–¥ –≤–∏–∫–ª–∏–∫–æ–º `RunEstimate()` –≤–∏—Ä–∞–∑ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `CheckCurrency()`, `ReplaceUnaryPlusMinus()` —Ç–∞ `Format()`.

3. **–ü–æ–º–∏–ª–∫–∏ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è:** –Ø–∫—â–æ –≤–∏—Ä–∞–∑ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π –Ω–∞ –µ—Ç–∞–ø—ñ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è, `Format()` –ø–æ–≤–µ—Ä–Ω–µ —Ä—è–¥–æ–∫, —â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ `&`. –£ —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É `RunEstimate()` –Ω–µ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è.

4. **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö:** –¢–µ—Å—Ç–∏ —á–∏—Ç–∞—é—Ç—å –¥–∞–Ω—ñ –∑ SQL Server. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ:
   - –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö —Å—Ç–≤–æ—Ä–µ–Ω–∞
   - –†—è–¥–æ–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π
   - SQL Server –∑–∞–ø—É—â–µ–Ω–∏–π

---

## üìù –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö —Ç–µ—Å—Ç—ñ–≤

–©–æ–± –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π —Ç–µ—Å—Ç–æ–≤–∏–π –≤–∏–ø–∞–¥–æ–∫:

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ SQL Server Management Studio
2. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ `CalculatorTestDB`
3. –í–∏–∫–æ–Ω–∞–π—Ç–µ INSERT:

```sql
INSERT INTO TestExpressions (TestName, Expression, ExpectedResult, IsError, ErrorCode, Description, TestCategory)
VALUES ('MyNewTest', '2+3', '5', 0, NULL, '–ú—ñ–π –Ω–æ–≤–∏–π —Ç–µ—Å—Ç', 'Valid');
```

–¢–µ—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑'—è–≤–∏—Ç—å—Å—è –≤ `RunEstimate_AllTestsFromDatabase`!

---

## üêõ –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Cannot connect to database"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä—è–¥–æ–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤ `App.config` —Ç–∞ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ SQL Server –∑–∞–ø—É—â–µ–Ω–∏–π.

### –ü—Ä–æ–±–ª–µ–º–∞: "MSTest references not found"
**–†—ñ—à–µ–Ω–Ω—è:** –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å MSTest —á–µ—Ä–µ–∑ NuGet –∞–±–æ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ Visual Studio Test Tools –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ.

### –ü—Ä–æ–±–ª–µ–º–∞: "Test fails with format error"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –≤–∏—Ä–∞–∑ —É –ë–î –∫–æ—Ä–µ–∫—Ç–Ω–∏–π. –ú–æ–∂–ª–∏–≤–æ, –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∏ –ø—Ä–æ–±—ñ–ª–∏ –∞–±–æ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å.

---

## üìö –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [MSTest Documentation](https://docs.microsoft.com/en-us/visualstudio/test/unit-test-basics)
- [SQL Server Documentation](https://docs.microsoft.com/en-us/sql/)
- [Reverse Polish Notation](https://en.wikipedia.org/wiki/Reverse_Polish_notation)

---

**–ê–≤—Ç–æ—Ä:** –í–∏–∫–æ–Ω–∞–Ω–æ –¥–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ ‚Ññ1  
**–î–∞—Ç–∞:** 2024  
**–í–∞—Ä—ñ–∞–Ω—Ç:** ‚Ññ9 (–º–µ—Ç–æ–¥ RunEstimate)
